{"remainingRequest":"/Users/curry/IdeaProjects/web/node_modules/babel-loader/lib/index.js!/Users/curry/IdeaProjects/web/src/core/directives/action.js","dependencies":[{"path":"/Users/curry/IdeaProjects/web/src/core/directives/action.js","mtime":1591698534000},{"path":"/Users/curry/IdeaProjects/web/node_modules/cache-loader/dist/cjs.js","mtime":1644834874663},{"path":"/Users/curry/IdeaProjects/web/node_modules/babel-loader/lib/index.js","mtime":1644834704109}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/web.dom.iterable\";\nimport Vue from 'vue';\nimport store from '@/store';\n/**\r\n * Action 权限指令\r\n * 指令用法：\r\n *  - 在需要控制 action 级别权限的组件上使用 v-action:[method] , 如下：\r\n *    <i-button v-action:add >添加用户</a-button>\r\n *    <a-button v-action:delete>删除用户</a-button>\r\n *    <a v-action:edit @click=\"edit(record)\">修改</a>\r\n *\r\n *  - 当前用户没有权限时，组件上使用了该指令则会被隐藏\r\n *\r\n *  - 当后台权限跟 pro 提供的模式不同时，只需要针对这里的权限过滤进行修改即可\r\n *\r\n *\r\n */\n\nvar action = Vue.directive('action', {\n  inserted: function inserted(el, binding, vnode) {\n    var actionName = binding.arg;\n    var roles = store.getters.roles;\n    var elVal = vnode.context.$route.meta.permission;\n    var permissionId = elVal instanceof String && [elVal] || elVal;\n    roles.permissions.forEach(function (p) {\n      if (!permissionId || !permissionId.includes(p.permissionId)) {\n        return;\n      }\n\n      console.log(p.actionList);\n\n      if (p.actionList && !p.actionList.includes(actionName)) {\n        el.parentNode && el.parentNode.removeChild(el) || (el.style.display = 'none');\n      }\n    });\n  }\n});\nexport default action;",{"version":3,"sources":["/Users/curry/IdeaProjects/web/src/core/directives/action.js"],"names":["Vue","store","action","directive","inserted","el","binding","vnode","actionName","arg","roles","getters","elVal","context","$route","meta","permission","permissionId","String","permissions","forEach","p","includes","console","log","actionList","parentNode","removeChild","style","display"],"mappings":";;;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AAEA;;;;;;;;;;;;;;;AAcA,IAAMC,MAAM,GAAGF,GAAG,CAACG,SAAJ,CAAc,QAAd,EAAwB;AACrCC,EAAAA,QAAQ,EAAE,kBAAUC,EAAV,EAAcC,OAAd,EAAuBC,KAAvB,EAA8B;AACtC,QAAMC,UAAU,GAAGF,OAAO,CAACG,GAA3B;AACA,QAAMC,KAAK,GAAGT,KAAK,CAACU,OAAN,CAAcD,KAA5B;AACA,QAAME,KAAK,GAAGL,KAAK,CAACM,OAAN,CAAcC,MAAd,CAAqBC,IAArB,CAA0BC,UAAxC;AACA,QAAMC,YAAY,GAAGL,KAAK,YAAYM,MAAjB,IAA2B,CAACN,KAAD,CAA3B,IAAsCA,KAA3D;AACAF,IAAAA,KAAK,CAACS,WAAN,CAAkBC,OAAlB,CAA0B,UAAAC,CAAC,EAAI;AAC7B,UAAI,CAACJ,YAAD,IAAiB,CAACA,YAAY,CAACK,QAAb,CAAsBD,CAAC,CAACJ,YAAxB,CAAtB,EAA6D;AAC3D;AACD;;AACDM,MAAAA,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACI,UAAd;;AACA,UAAIJ,CAAC,CAACI,UAAF,IAAgB,CAACJ,CAAC,CAACI,UAAF,CAAaH,QAAb,CAAsBd,UAAtB,CAArB,EAAwD;AACtDH,QAAAA,EAAE,CAACqB,UAAH,IAAiBrB,EAAE,CAACqB,UAAH,CAAcC,WAAd,CAA0BtB,EAA1B,CAAjB,KAAmDA,EAAE,CAACuB,KAAH,CAASC,OAAT,GAAmB,MAAtE;AACD;AACF,KARD;AASD;AAfoC,CAAxB,CAAf;AAkBA,eAAe3B,MAAf","sourcesContent":["import Vue from 'vue'\r\nimport store from '@/store'\r\n\r\n/**\r\n * Action 权限指令\r\n * 指令用法：\r\n *  - 在需要控制 action 级别权限的组件上使用 v-action:[method] , 如下：\r\n *    <i-button v-action:add >添加用户</a-button>\r\n *    <a-button v-action:delete>删除用户</a-button>\r\n *    <a v-action:edit @click=\"edit(record)\">修改</a>\r\n *\r\n *  - 当前用户没有权限时，组件上使用了该指令则会被隐藏\r\n *\r\n *  - 当后台权限跟 pro 提供的模式不同时，只需要针对这里的权限过滤进行修改即可\r\n *\r\n *\r\n */\r\nconst action = Vue.directive('action', {\r\n  inserted: function (el, binding, vnode) {\r\n    const actionName = binding.arg\r\n    const roles = store.getters.roles\r\n    const elVal = vnode.context.$route.meta.permission\r\n    const permissionId = elVal instanceof String && [elVal] || elVal\r\n    roles.permissions.forEach(p => {\r\n      if (!permissionId || !permissionId.includes(p.permissionId)) {\r\n        return\r\n      }\r\n      console.log(p.actionList)\r\n      if (p.actionList && !p.actionList.includes(actionName)) {\r\n        el.parentNode && el.parentNode.removeChild(el) || (el.style.display = 'none')\r\n      }\r\n    })\r\n  }\r\n})\r\n\r\nexport default action\r\n"]}]}