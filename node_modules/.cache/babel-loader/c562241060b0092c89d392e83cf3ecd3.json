{"remainingRequest":"/Users/curry/IdeaProjects/web/node_modules/babel-loader/lib/index.js!/Users/curry/IdeaProjects/web/src/permission.js","dependencies":[{"path":"/Users/curry/IdeaProjects/web/src/permission.js","mtime":1618996304000},{"path":"/Users/curry/IdeaProjects/web/node_modules/cache-loader/dist/cjs.js","mtime":1644834874663},{"path":"/Users/curry/IdeaProjects/web/node_modules/babel-loader/lib/index.js","mtime":1644834704109}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es7.array.includes\";\nimport Vue from 'vue';\nimport router from './router';\nimport store from './store';\nimport NProgress from 'nprogress'; // progress bar\n\nimport 'nprogress/nprogress.css'; // progress bar style\n\nimport { setDocumentTitle, domTitle } from '@/utils/domUtil';\nimport { USER_INFO } from '@/store/mutation-types';\nNProgress.configure({\n  showSpinner: false\n}); // NProgress Configuration\n\nvar whiteList = ['login', 'register', 'registerResult', 'RetrievePwd', 'CommonAbout']; // no redirect whitelist\n\nrouter.beforeEach(function (to, from, next) {\n  NProgress.start(); // start progress bar\n\n  to.meta && typeof to.meta.title !== 'undefined' && setDocumentTitle(\"\".concat(to.meta.title, \" - \").concat(domTitle)); //处理未登录的开发\n  // const userInfo ={\n  //   id: \"123\",\n  //   userName: \"123\",\n  //   token: \"123\"\n  // }\n  // Vue.ls.set(USER_INFO, userInfo, 3 * 60 * 60 * 1000)\n\n  if (Vue.ls.get(USER_INFO)) {\n    store.dispatch('setUserInfo');\n    /* has token */\n\n    if (to.path === '/user/login') {\n      next({\n        path: '/dashboard/workplace'\n      });\n      NProgress.done();\n    } else {\n      next();\n    }\n  } else {\n    if (whiteList.includes(to.name)) {\n      // 在免登录白名单，直接进入\n      next();\n    } else {\n      next({\n        path: '/user/login',\n        query: {\n          redirect: to.fullPath\n        }\n      });\n      NProgress.done(); // if current page is login will not trigger afterEach hook, so manually handle it\n    }\n  }\n});\nrouter.afterEach(function () {\n  NProgress.done(); // finish progress bar\n});",{"version":3,"sources":["/Users/curry/IdeaProjects/web/src/permission.js"],"names":["Vue","router","store","NProgress","setDocumentTitle","domTitle","USER_INFO","configure","showSpinner","whiteList","beforeEach","to","from","next","start","meta","title","ls","get","dispatch","path","done","includes","name","query","redirect","fullPath","afterEach"],"mappings":";;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AAEA,OAAOC,SAAP,MAAsB,WAAtB,C,CAAkC;;AAClC,OAAO,yBAAP,C,CAAiC;;AACjC,SAASC,gBAAT,EAA2BC,QAA3B,QAA2C,iBAA3C;AACA,SAASC,SAAT,QAA0B,wBAA1B;AAEAH,SAAS,CAACI,SAAV,CAAoB;AAAEC,EAAAA,WAAW,EAAE;AAAf,CAApB,E,CAA4C;;AAE5C,IAAMC,SAAS,GAAG,CAAC,OAAD,EAAU,UAAV,EAAsB,gBAAtB,EAAwC,aAAxC,EAAuD,aAAvD,CAAlB,C,CAAwF;;AAExFR,MAAM,CAACS,UAAP,CAAkB,UAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAoB;AACpCV,EAAAA,SAAS,CAACW,KAAV,GADoC,CAClB;;AAClBH,EAAAA,EAAE,CAACI,IAAH,IAAY,OAAOJ,EAAE,CAACI,IAAH,CAAQC,KAAf,KAAyB,WAAzB,IAAwCZ,gBAAgB,WAAIO,EAAE,CAACI,IAAH,CAAQC,KAAZ,gBAAuBX,QAAvB,EAApE,CAFoC,CAIpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA,MAAIL,GAAG,CAACiB,EAAJ,CAAOC,GAAP,CAAWZ,SAAX,CAAJ,EAA2B;AACvBJ,IAAAA,KAAK,CAACiB,QAAN,CAAe,aAAf;AAGF;;AACA,QAAIR,EAAE,CAACS,IAAH,KAAY,aAAhB,EAA+B;AAC7BP,MAAAA,IAAI,CAAC;AAAEO,QAAAA,IAAI,EAAE;AAAR,OAAD,CAAJ;AACAjB,MAAAA,SAAS,CAACkB,IAAV;AACD,KAHD,MAGO;AACLR,MAAAA,IAAI;AACL;AACF,GAXD,MAWO;AACL,QAAIJ,SAAS,CAACa,QAAV,CAAmBX,EAAE,CAACY,IAAtB,CAAJ,EAAiC;AAC/B;AACAV,MAAAA,IAAI;AACL,KAHD,MAGO;AACLA,MAAAA,IAAI,CAAC;AAAEO,QAAAA,IAAI,EAAE,aAAR;AAAuBI,QAAAA,KAAK,EAAE;AAAEC,UAAAA,QAAQ,EAAEd,EAAE,CAACe;AAAf;AAA9B,OAAD,CAAJ;AACAvB,MAAAA,SAAS,CAACkB,IAAV,GAFK,CAEY;AAClB;AACF;AACF,CAjCD;AAmCApB,MAAM,CAAC0B,SAAP,CAAiB,YAAM;AACrBxB,EAAAA,SAAS,CAACkB,IAAV,GADqB,CACJ;AAClB,CAFD","sourcesContent":["import Vue from 'vue'\r\nimport router from './router'\r\nimport store from './store'\r\n\r\nimport NProgress from 'nprogress' // progress bar\r\nimport 'nprogress/nprogress.css' // progress bar style\r\nimport { setDocumentTitle, domTitle } from '@/utils/domUtil'\r\nimport { USER_INFO } from '@/store/mutation-types'\r\n\r\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\r\n\r\nconst whiteList = ['login', 'register', 'registerResult', 'RetrievePwd', 'CommonAbout'] // no redirect whitelist\r\n\r\nrouter.beforeEach((to, from, next) => {\r\n  NProgress.start() // start progress bar\r\n  to.meta && (typeof to.meta.title !== 'undefined' && setDocumentTitle(`${to.meta.title} - ${domTitle}`))\r\n  \r\n  //处理未登录的开发\r\n  // const userInfo ={\r\n  //   id: \"123\",\r\n  //   userName: \"123\",\r\n  //   token: \"123\"\r\n  // }\r\n  // Vue.ls.set(USER_INFO, userInfo, 3 * 60 * 60 * 1000)\r\n\r\n\r\n  if (Vue.ls.get(USER_INFO)) {\r\n      store.dispatch('setUserInfo')\r\n\r\n\r\n    /* has token */\r\n    if (to.path === '/user/login') {\r\n      next({ path: '/dashboard/workplace' })\r\n      NProgress.done()\r\n    } else {\r\n      next()\r\n    }\r\n  } else {\r\n    if (whiteList.includes(to.name)) {\r\n      // 在免登录白名单，直接进入\r\n      next()\r\n    } else {\r\n      next({ path: '/user/login', query: { redirect: to.fullPath } })\r\n      NProgress.done() // if current page is login will not trigger afterEach hook, so manually handle it\r\n    }\r\n  }\r\n})\r\n\r\nrouter.afterEach(() => {\r\n  NProgress.done() // finish progress bar\r\n})\r\n"]}]}