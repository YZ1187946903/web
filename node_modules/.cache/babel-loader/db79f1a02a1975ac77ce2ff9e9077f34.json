{"remainingRequest":"/Users/curry/IdeaProjects/web/node_modules/babel-loader/lib/index.js!/Users/curry/IdeaProjects/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/curry/IdeaProjects/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/curry/IdeaProjects/web/src/views/transport/Transport.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/curry/IdeaProjects/web/src/views/transport/Transport.vue","mtime":1644835876426},{"path":"/Users/curry/IdeaProjects/web/node_modules/cache-loader/dist/cjs.js","mtime":1644834874663},{"path":"/Users/curry/IdeaProjects/web/node_modules/babel-loader/lib/index.js","mtime":1644834704109},{"path":"/Users/curry/IdeaProjects/web/node_modules/cache-loader/dist/cjs.js","mtime":1644834874663},{"path":"/Users/curry/IdeaProjects/web/node_modules/vue-loader/lib/index.js","mtime":1644834877865}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/curry/IdeaProjects/web/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/Users/curry/IdeaProjects/web/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getList } from '@/api/truck';\nimport { getTranList, handlex } from '@/api/transport';\nimport add from '@/assets/yard/add.svg?inline';\nimport { mapGetters } from 'vuex';\nimport VueAmap from 'vue-amap';\nexport default {\n  name: 'TransportList',\n  data: function data() {\n    return {\n      add: add,\n      showAddmodal: false,\n      loadingSave: false,\n      loading: false,\n      infoList: [],\n      truckNum: \"\",\n      name: \"\",\n      mobile: \"\",\n      total: 0,\n      //列表总条数\n      pageParams: {\n        pageSize: 10,\n        pageNum: 1 // total: 10\n\n      },\n      tranId: \"\",\n      truckList: [],\n      dateValue: [],\n      date0: \"\",\n      selected: \"\",\n      columns: [{\n        title: '运单编号',\n        dataIndex: 'id'\n      }, {\n        title: '车牌号',\n        dataIndex: 'truckNum'\n      }, {\n        title: '司机名称',\n        dataIndex: 'driverName'\n      }, {\n        title: '司机电话',\n        dataIndex: 'driverMobile'\n      }, {\n        title: '状态',\n        dataIndex: 'status',\n        scopedSlots: {\n          customRender: 'statusFormat'\n        }\n      }, {\n        title: '发起时间',\n        dataIndex: 'createTime',\n        scopedSlots: {\n          customRender: 'timeFormat'\n        }\n      }, {\n        title: '操作',\n        scopedSlots: {\n          customRender: 'operation'\n        }\n      }],\n      truckColumns: [{\n        title: '车牌号',\n        dataIndex: 'truckNum'\n      }, {\n        title: '司机名称',\n        dataIndex: 'driverName'\n      }, {\n        title: '司机电话',\n        dataIndex: 'driverMobile'\n      }, {\n        title: '操作',\n        scopedSlots: {\n          customRender: 'operation'\n        }\n      }],\n      plugin: []\n    };\n  },\n  watch: {\n    showAddmodal: function showAddmodal(newVal, oldVal) {\n      if (!newVal) {\n        this.closeAlert();\n      }\n    }\n  },\n  methods: _objectSpread({\n    addTranModel: function () {\n      var _addTranModel = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(id) {\n        var pageParam, res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.tranId = id;\n                _context.prev = 1;\n                pageParam = {};\n                _context.next = 5;\n                return getList(pageParam);\n\n              case 5:\n                res = _context.sent;\n\n                if (res.code == 200) {\n                  this.truckList = res.data.list;\n                } else {\n                  this.$message.error(res.message, 2);\n                }\n\n                _context.next = 13;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](1);\n                this.loading = false;\n                this.$message.error(\"网络错误\", 2);\n\n              case 13:\n                this.showAddmodal = true;\n                this.isSelectClickMap = false;\n                console.log(this.isSelectClickMap);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 9]]);\n      }));\n\n      function addTranModel(_x) {\n        return _addTranModel.apply(this, arguments);\n      }\n\n      return addTranModel;\n    }(),\n    onChange: function onChange(value, dateString) {\n      console.log('Selected Time: ', dateString);\n\n      if (dateString.length > 0) {\n        this.dateValue = dateString;\n        this.date0 = value;\n      } else {\n        this.dateValue = null;\n      }\n    },\n    editOne: function editOne(id) {\n      var _this = this;\n\n      var params = {\n        truckId: id,\n        id: this.tranId\n      };\n      handlex(params).then(function (res) {\n        if (res.code == 200) {\n          _this.$notification['success']({\n            message: '提示',\n            description: res.msg,\n            duration: 2\n          });\n\n          _this.showAddmodal = false;\n\n          _this.getPageList();\n        } else {\n          _this.$notification['warning']({\n            message: '提示',\n            description: res.msg,\n            duration: 2\n          });\n        }\n\n        _this.loadingSave = false;\n      }).catch(function (e) {\n        _this.loadingSave = false;\n\n        _this.$notification['error']({\n          message: '提示',\n          description: \"添加失败，网络错误\",\n          duration: 2\n        });\n      });\n    },\n    handleChanges: function handleChanges(value) {\n      this.selected = value;\n    }\n  }, mapGetters([\"userInfo\"]), {\n    addInfoTo: function addInfoTo() {\n      this.showAddmodal = true;\n      this.isSelectClickMap = false;\n      console.log(this.isSelectClickMap);\n    },\n\n    /**\n    * 关闭弹窗\n    */\n    closeAlert: function closeAlert() {\n      this.showAddmodal = false;\n      this.contruldress = false;\n      this.center = [116.416357, 39.928353];\n      this.addValue.mobile = '';\n      this.addValue.name = '';\n      this.addValue.truckNum = '';\n      this.addValue.cardNum = '';\n      this.addValue.driverNum = '';\n      this.isEdit = true;\n      this.isSelectClickMap = false;\n\n      if (this.isEdit) {\n        this.isEdit = false;\n      }\n    },\n    getPageList: function () {\n      var _getPageList = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.loading = true;\n                _context2.prev = 1;\n                this.pageParams.startTime = this.dateValue[0];\n                this.pageParams.endTime = this.dateValue[1];\n\n                if (this.selected) {\n                  this.pageParams.status = this.selected;\n                }\n\n                _context2.next = 7;\n                return getTranList(this.pageParams);\n\n              case 7:\n                res = _context2.sent;\n                this.loading = false;\n\n                if (res.code == 200) {\n                  this.infoList = res.data.list;\n                  this.total = res.data.total; // this.pageParams.total = res.rowCount\n                } else {\n                  this.$message.error(res.message, 2);\n                }\n\n                _context2.next = 16;\n                break;\n\n              case 12:\n                _context2.prev = 12;\n                _context2.t0 = _context2[\"catch\"](1);\n                this.loading = false;\n                this.$message.error(\"网络错误\", 2);\n\n              case 16:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[1, 12]]);\n      }));\n\n      function getPageList() {\n        return _getPageList.apply(this, arguments);\n      }\n\n      return getPageList;\n    }(),\n    search: function search() {\n      this.pageParams.pageNum = 1;\n      this.pageParams.pageSize = 10;\n      this.getPageList();\n    },\n    pageChange: function pageChange(page, size) {\n      //修改分页\n      this.pageParams.pageSize = size;\n      this.pageParams.pageNum = page; // reqParams\n\n      this.getPageList();\n    },\n    changeValue: function changeValue(v) {\n      if (this.isSelectClickMap) {\n        this.searchAddr(this.addValue.detailAddr);\n      } else {\n        this.addValue.detailAddr = '';\n        this.$message.warn(\"请先选择省市区\", 1);\n      }\n    },\n    toInfo: function toInfo(id) {\n      this.$router.push({\n        name: 'TransportInfo',\n        query: {\n          tansportId: id\n        }\n      });\n    }\n  }),\n  created: function created() {\n    this.amapManager = new VueAmap.AMapManager();\n    this.getPageList();\n  }\n};",{"version":3,"sources":["Transport.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n\n    <div  style=\"margin: 15px 0px;\">\n      <a-range-picker\n        :showTime=\"{ format: 'HH:mm' }\"\n        format=\"YYYY-MM-DD HH:mm\"\n        :value=\"date0\"\n        :placeholder=\"['开始时间', '结束时间']\"\n        @change=\"onChange\"\n      />\n       <a-select defaultValue=\"\" style=\"width: 150px\" @change=\"handleChanges\" >\n        <a-select-option value=\"\">请选择运单状态</a-select-option>\n        <a-select-option value=\"0\">配货中</a-select-option>\n        <a-select-option value=\"1\">交接中</a-select-option>\n        <a-select-option value=\"3\">已完成</a-select-option>\n        <a-select-option value=\"4\">异常</a-select-option>\n       </a-select>\n\n      <a-button type=\"primary\" style=\"margin-left: 10px;\" @click=\"search\">搜索</a-button>\n\n    </div>\n    <div>\n    <a-table :columns=\"columns\" :dataSource=\"infoList\"  :pagination=\"false\">\n        <template slot=\"statusFormat\" slot-scope=\"text\">\n            <span  v-if=\"text == 0\" style='color: #51C758'>配送中</span>\n            <span  v-if=\"text == 1\" style='color: #2a5caa'>交接中</span>\n            <span  v-if=\"text == 3\" style='color: #3A92EA'>已完成</span>\n            <span  v-if=\"text == 4\" style='color: #F4AC3E'>异常</span>\n        </template>\n\n        <span slot=\"timeFormat\" slot-scope=\"text, record\">\n             {{ record.createTime.replace(\"T\",\" \") }}\n        </span>\n\n        <template slot=\"operation\" slot-scope=\"text, record\">\n          <a-button type=\"primary\" @click=\"toInfo(record.id)\" >详情</a-button>&nbsp;\n          <a-button v-if=\"record.status == 4\" type=\"primary\" @click=\"addTranModel(record.id)\" >异常处理</a-button>\n          <a-button v-else type=\"primary\" disabled=\"disabled\" >异常处理</a-button>\n        </template>\n    </a-table>\n      <div class=\"pageInfo\">\n        <a-pagination\n          :total=total\n          :pageSize=pageParams.pageSize\n          :current=pageParams.pageNum\n          :showTotal=\"(total, range) => `共${total}条数据`\"\n          @change=\"pageChange\"\n          @showSizeChange=\"pageChange\"\n        />\n      </div>\n    </div>\n\n    <div  v-show=\"showAddmodal\">\n      <a-modal\n        title=\"\"\n        v-model=\"showAddmodal\"\n        width=\"1000px\"\n        :maskClosable=\"false\"\n        :footer=\"null\"\n        :closable=\"false\"\n        style=\"top: 20px;bottom: 0px;\"\n\n      >\n        <div class=\"modal-header\" @click=\"closeAlert\">\n          <a-icon :component=\"close\" style=\"font-size: 22px\"/>\n        </div>\n        <br>\n        <div class=\"modal-header-content\">\n          <span style=\"font-size: 20px;color: black\">选择车辆</span>\n        </div>\n            <a-table :columns=\"truckColumns\"\n            :dataSource=\"truckList\"\n            :pagination=\"false\"\n            >\n                <template slot=\"operation\" slot-scope=\"text, record\">\n                  <a-button type=\"primary\" @click=\"editOne(record.id)\" >选择</a-button>\n                </template>\n            </a-table>\n\n        <div class=\"modal-content-bottom\">\n          <a-button style=\"margin-left: 10px\" @click=\"closeAlert\">返回</a-button>\n        </div>\n      </a-modal>\n    </div>\n\n\n  </div>\n</template>\n\n<script>\n  import {getList} from '@/api/truck'\n  import {getTranList,handlex} from '@/api/transport'\n  import add from '@/assets/yard/add.svg?inline'\n  import {mapGetters} from 'vuex'\n  import VueAmap from 'vue-amap'\n  export default {\n    name: 'TransportList',\n    data(){\n       return{\n         add,\n         showAddmodal:false,\n         loadingSave:false,\n         loading:false,\n         infoList:[],\n         truckNum:\"\",\n         name:\"\",\n         mobile:\"\",\n         total:0, //列表总条数\n         pageParams:{\n           pageSize: 10,\n           pageNum: 1,\n           // total: 10\n         },\n         tranId:\"\",\n         truckList:[],\n         dateValue:[],\n         date0:\"\",\n         selected:\"\",\n         columns:[\n            {\n             title: '运单编号',\n             dataIndex: 'id',\n           },\n           {\n             title: '车牌号',\n             dataIndex: 'truckNum',\n           }, {\n             title: '司机名称',\n             dataIndex: 'driverName',\n           },{\n             title: '司机电话',\n             dataIndex: 'driverMobile',\n           },\n           {\n             title: '状态',\n             dataIndex: 'status',\n             scopedSlots: { customRender: 'statusFormat' },\n           },\n           {\n             title: '发起时间',\n             dataIndex: 'createTime',\n             scopedSlots: { customRender: 'timeFormat' },\n           },{\n                title: '操作',\n                scopedSlots: { customRender: 'operation' }\n            }\n         ],\n        truckColumns:[\n           {\n             title: '车牌号',\n             dataIndex: 'truckNum',\n           }, {\n             title: '司机名称',\n             dataIndex: 'driverName',\n           }, {\n             title: '司机电话',\n             dataIndex: 'driverMobile',\n           },{\n                title: '操作',\n                scopedSlots: { customRender: 'operation' }\n            }\n         ],\n        plugin: [],\n\n      }\n    },\n    watch:{\n      showAddmodal(newVal,oldVal){\n\n        if(!newVal){\n          this.closeAlert();\n        }\n      }\n    },\n    methods:{\n      async addTranModel(id){\n         this.tranId=id\n         try {\n          let pageParam={};\n          let res=await getList(pageParam);\n          if(res.code==200) {\n            this.truckList=res.data.list;\n          }else {\n            this.$message.error(res.message, 2)\n          }\n        }catch (e) {\n          this.loading = false\n          this.$message.error(\"网络错误\",2);\n        }\n        this.showAddmodal=true\n        this.isSelectClickMap=false;\n        console.log( this.isSelectClickMap)\n      },\n\n      onChange (value, dateString) {\n        console.log('Selected Time: ', dateString)\n        if (dateString.length > 0){\n            this.dateValue = dateString;\n            this.date0 = value;\n\n        }else {\n            this.dateValue = null;\n        }\n      },\n      editOne(id){\n        let params={\n          truckId:id,\n          id:this.tranId\n        };\n\n        handlex(params).then(res=>{\n            if(res.code==200){\n              this.$notification['success']({\n                message: '提示',\n                description: res.msg,\n                duration: 2\n              })\n           this.showAddmodal=false;\n           this.getPageList();\n\n            }else{\n              this.$notification['warning']({\n                message: '提示',\n                description: res.msg,\n                duration: 2\n              })\n            }\n            this.loadingSave=false;\n          }).catch(e=>{\n            this.loadingSave=false;\n            this.$notification['error']({\n              message: '提示',\n              description: \"添加失败，网络错误\",\n              duration: 2\n            })\n          })\n      },\n\n      handleChanges(value){\n        this.selected = value;\n      },\n\n      ...mapGetters([\"userInfo\"]),\n\n\n      addInfoTo(){\n        this.showAddmodal=true\n        this.isSelectClickMap=false;\n        console.log( this.isSelectClickMap)\n      },\n            /**\n       * 关闭弹窗\n       */\n      closeAlert(){\n        this.showAddmodal=false;\n        this.contruldress=false;\n        this.center=[116.416357, 39.928353];\n        this.addValue.mobile='';\n        this.addValue.name='';\n        this.addValue.truckNum='';\n        this.addValue.cardNum='';\n        this.addValue.driverNum='';\n        this.isEdit=true;\n        this.isSelectClickMap=false;\n        if(this.isEdit){\n          this.isEdit=false;\n        }\n\n      },\n      async getPageList(){\n        this.loading = true\n        try {\n          this.pageParams.startTime=this.dateValue[0];\n          this.pageParams.endTime=this.dateValue[1];\n          if(this.selected){\n              this.pageParams.status=this.selected;\n          }\n          let res=await getTranList(this.pageParams);\n          this.loading = false\n          if(res.code==200) {\n            this.infoList=res.data.list;\n            this.total=res.data.total;\n            // this.pageParams.total = res.rowCount\n          }else {\n            this.$message.error(res.message, 2)\n          }\n        }catch (e) {\n          this.loading = false\n          this.$message.error(\"网络错误\",2);\n        }\n      },\n      search(){\n        this.pageParams.pageNum=1;\n        this.pageParams.pageSize=10;\n        this.getPageList()\n      },\n      pageChange(page,size){ //修改分页\n        this.pageParams.pageSize=size\n        this.pageParams.pageNum=page\n        // reqParams\n        this.getPageList()\n\n      },\n\n      changeValue(v){\n        if(this.isSelectClickMap){\n          this.searchAddr(this.addValue.detailAddr);\n        }else{\n          this.addValue.detailAddr='';\n          this.$message.warn(\"请先选择省市区\",1);\n        }\n      },\n      toInfo(id){\n            this.$router.push({\n            name:'TransportInfo',\n            query:{\n                tansportId:id\n            }\n            })\n      },\n    },\n\n\n    created(){\n       this.amapManager=new VueAmap.AMapManager();\n       this.getPageList()\n    }\n  }\n</script>\n\n<style  scoped lang=\"less\">\n  .pageInfo {\n    padding-top: 24px;\n    float: right;\n  }\n</style>"],"sourceRoot":"src/views/transport"}]}