{"remainingRequest":"/Users/curry/IdeaProjects/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/curry/IdeaProjects/web/src/views/transport/Transport.vue?vue&type=style&index=0&id=6a5b280e&scoped=true&lang=less&","dependencies":[{"path":"/Users/curry/IdeaProjects/web/src/views/transport/Transport.vue","mtime":1644835876426},{"path":"/Users/curry/IdeaProjects/web/node_modules/css-loader/index.js","mtime":1644834704815},{"path":"/Users/curry/IdeaProjects/web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1644834877865},{"path":"/Users/curry/IdeaProjects/web/node_modules/postcss-loader/src/index.js","mtime":1644834877019},{"path":"/Users/curry/IdeaProjects/web/node_modules/less-loader/dist/cjs.js","mtime":1644834920680},{"path":"/Users/curry/IdeaProjects/web/node_modules/cache-loader/dist/cjs.js","mtime":1644834874663},{"path":"/Users/curry/IdeaProjects/web/node_modules/vue-loader/lib/index.js","mtime":1644834877865}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.pageInfo {\n  padding-top: 24px;\n  float: right;\n}\n",{"version":3,"sources":["Transport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4UA;AACA;AACA;AACA","file":"Transport.vue","sourceRoot":"src/views/transport","sourcesContent":["<template>\n  <div>\n\n    <div  style=\"margin: 15px 0px;\">\n      <a-range-picker\n        :showTime=\"{ format: 'HH:mm' }\"\n        format=\"YYYY-MM-DD HH:mm\"\n        :value=\"date0\"\n        :placeholder=\"['开始时间', '结束时间']\"\n        @change=\"onChange\"\n      />\n       <a-select defaultValue=\"\" style=\"width: 150px\" @change=\"handleChanges\" >\n        <a-select-option value=\"\">请选择运单状态</a-select-option>\n        <a-select-option value=\"0\">配货中</a-select-option>\n        <a-select-option value=\"1\">交接中</a-select-option>\n        <a-select-option value=\"3\">已完成</a-select-option>\n        <a-select-option value=\"4\">异常</a-select-option>\n       </a-select>\n\n      <a-button type=\"primary\" style=\"margin-left: 10px;\" @click=\"search\">搜索</a-button>\n\n    </div>\n    <div>\n    <a-table :columns=\"columns\" :dataSource=\"infoList\"  :pagination=\"false\">\n        <template slot=\"statusFormat\" slot-scope=\"text\">\n            <span  v-if=\"text == 0\" style='color: #51C758'>配送中</span>\n            <span  v-if=\"text == 1\" style='color: #2a5caa'>交接中</span>\n            <span  v-if=\"text == 3\" style='color: #3A92EA'>已完成</span>\n            <span  v-if=\"text == 4\" style='color: #F4AC3E'>异常</span>\n        </template>\n\n        <span slot=\"timeFormat\" slot-scope=\"text, record\">\n             {{ record.createTime.replace(\"T\",\" \") }}\n        </span>\n\n        <template slot=\"operation\" slot-scope=\"text, record\">\n          <a-button type=\"primary\" @click=\"toInfo(record.id)\" >详情</a-button>&nbsp;\n          <a-button v-if=\"record.status == 4\" type=\"primary\" @click=\"addTranModel(record.id)\" >异常处理</a-button>\n          <a-button v-else type=\"primary\" disabled=\"disabled\" >异常处理</a-button>\n        </template>\n    </a-table>\n      <div class=\"pageInfo\">\n        <a-pagination\n          :total=total\n          :pageSize=pageParams.pageSize\n          :current=pageParams.pageNum\n          :showTotal=\"(total, range) => `共${total}条数据`\"\n          @change=\"pageChange\"\n          @showSizeChange=\"pageChange\"\n        />\n      </div>\n    </div>\n\n    <div  v-show=\"showAddmodal\">\n      <a-modal\n        title=\"\"\n        v-model=\"showAddmodal\"\n        width=\"1000px\"\n        :maskClosable=\"false\"\n        :footer=\"null\"\n        :closable=\"false\"\n        style=\"top: 20px;bottom: 0px;\"\n\n      >\n        <div class=\"modal-header\" @click=\"closeAlert\">\n          <a-icon :component=\"close\" style=\"font-size: 22px\"/>\n        </div>\n        <br>\n        <div class=\"modal-header-content\">\n          <span style=\"font-size: 20px;color: black\">选择车辆</span>\n        </div>\n            <a-table :columns=\"truckColumns\"\n            :dataSource=\"truckList\"\n            :pagination=\"false\"\n            >\n                <template slot=\"operation\" slot-scope=\"text, record\">\n                  <a-button type=\"primary\" @click=\"editOne(record.id)\" >选择</a-button>\n                </template>\n            </a-table>\n\n        <div class=\"modal-content-bottom\">\n          <a-button style=\"margin-left: 10px\" @click=\"closeAlert\">返回</a-button>\n        </div>\n      </a-modal>\n    </div>\n\n\n  </div>\n</template>\n\n<script>\n  import {getList} from '@/api/truck'\n  import {getTranList,handlex} from '@/api/transport'\n  import add from '@/assets/yard/add.svg?inline'\n  import {mapGetters} from 'vuex'\n  import VueAmap from 'vue-amap'\n  export default {\n    name: 'TransportList',\n    data(){\n       return{\n         add,\n         showAddmodal:false,\n         loadingSave:false,\n         loading:false,\n         infoList:[],\n         truckNum:\"\",\n         name:\"\",\n         mobile:\"\",\n         total:0, //列表总条数\n         pageParams:{\n           pageSize: 10,\n           pageNum: 1,\n           // total: 10\n         },\n         tranId:\"\",\n         truckList:[],\n         dateValue:[],\n         date0:\"\",\n         selected:\"\",\n         columns:[\n            {\n             title: '运单编号',\n             dataIndex: 'id',\n           },\n           {\n             title: '车牌号',\n             dataIndex: 'truckNum',\n           }, {\n             title: '司机名称',\n             dataIndex: 'driverName',\n           },{\n             title: '司机电话',\n             dataIndex: 'driverMobile',\n           },\n           {\n             title: '状态',\n             dataIndex: 'status',\n             scopedSlots: { customRender: 'statusFormat' },\n           },\n           {\n             title: '发起时间',\n             dataIndex: 'createTime',\n             scopedSlots: { customRender: 'timeFormat' },\n           },{\n                title: '操作',\n                scopedSlots: { customRender: 'operation' }\n            }\n         ],\n        truckColumns:[\n           {\n             title: '车牌号',\n             dataIndex: 'truckNum',\n           }, {\n             title: '司机名称',\n             dataIndex: 'driverName',\n           }, {\n             title: '司机电话',\n             dataIndex: 'driverMobile',\n           },{\n                title: '操作',\n                scopedSlots: { customRender: 'operation' }\n            }\n         ],\n        plugin: [],\n\n      }\n    },\n    watch:{\n      showAddmodal(newVal,oldVal){\n\n        if(!newVal){\n          this.closeAlert();\n        }\n      }\n    },\n    methods:{\n      async addTranModel(id){\n         this.tranId=id\n         try {\n          let pageParam={};\n          let res=await getList(pageParam);\n          if(res.code==200) {\n            this.truckList=res.data.list;\n          }else {\n            this.$message.error(res.message, 2)\n          }\n        }catch (e) {\n          this.loading = false\n          this.$message.error(\"网络错误\",2);\n        }\n        this.showAddmodal=true\n        this.isSelectClickMap=false;\n        console.log( this.isSelectClickMap)\n      },\n\n      onChange (value, dateString) {\n        console.log('Selected Time: ', dateString)\n        if (dateString.length > 0){\n            this.dateValue = dateString;\n            this.date0 = value;\n\n        }else {\n            this.dateValue = null;\n        }\n      },\n      editOne(id){\n        let params={\n          truckId:id,\n          id:this.tranId\n        };\n\n        handlex(params).then(res=>{\n            if(res.code==200){\n              this.$notification['success']({\n                message: '提示',\n                description: res.msg,\n                duration: 2\n              })\n           this.showAddmodal=false;\n           this.getPageList();\n\n            }else{\n              this.$notification['warning']({\n                message: '提示',\n                description: res.msg,\n                duration: 2\n              })\n            }\n            this.loadingSave=false;\n          }).catch(e=>{\n            this.loadingSave=false;\n            this.$notification['error']({\n              message: '提示',\n              description: \"添加失败，网络错误\",\n              duration: 2\n            })\n          })\n      },\n\n      handleChanges(value){\n        this.selected = value;\n      },\n\n      ...mapGetters([\"userInfo\"]),\n\n\n      addInfoTo(){\n        this.showAddmodal=true\n        this.isSelectClickMap=false;\n        console.log( this.isSelectClickMap)\n      },\n            /**\n       * 关闭弹窗\n       */\n      closeAlert(){\n        this.showAddmodal=false;\n        this.contruldress=false;\n        this.center=[116.416357, 39.928353];\n        this.addValue.mobile='';\n        this.addValue.name='';\n        this.addValue.truckNum='';\n        this.addValue.cardNum='';\n        this.addValue.driverNum='';\n        this.isEdit=true;\n        this.isSelectClickMap=false;\n        if(this.isEdit){\n          this.isEdit=false;\n        }\n\n      },\n      async getPageList(){\n        this.loading = true\n        try {\n          this.pageParams.startTime=this.dateValue[0];\n          this.pageParams.endTime=this.dateValue[1];\n          if(this.selected){\n              this.pageParams.status=this.selected;\n          }\n          let res=await getTranList(this.pageParams);\n          this.loading = false\n          if(res.code==200) {\n            this.infoList=res.data.list;\n            this.total=res.data.total;\n            // this.pageParams.total = res.rowCount\n          }else {\n            this.$message.error(res.message, 2)\n          }\n        }catch (e) {\n          this.loading = false\n          this.$message.error(\"网络错误\",2);\n        }\n      },\n      search(){\n        this.pageParams.pageNum=1;\n        this.pageParams.pageSize=10;\n        this.getPageList()\n      },\n      pageChange(page,size){ //修改分页\n        this.pageParams.pageSize=size\n        this.pageParams.pageNum=page\n        // reqParams\n        this.getPageList()\n\n      },\n\n      changeValue(v){\n        if(this.isSelectClickMap){\n          this.searchAddr(this.addValue.detailAddr);\n        }else{\n          this.addValue.detailAddr='';\n          this.$message.warn(\"请先选择省市区\",1);\n        }\n      },\n      toInfo(id){\n            this.$router.push({\n            name:'TransportInfo',\n            query:{\n                tansportId:id\n            }\n            })\n      },\n    },\n\n\n    created(){\n       this.amapManager=new VueAmap.AMapManager();\n       this.getPageList()\n    }\n  }\n</script>\n\n<style  scoped lang=\"less\">\n  .pageInfo {\n    padding-top: 24px;\n    float: right;\n  }\n</style>"]}]}