{"remainingRequest":"/Users/curry/IdeaProjects/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/curry/IdeaProjects/web/src/views/info/Goods.vue?vue&type=style&index=0&id=3b13aca2&scoped=true&lang=less&","dependencies":[{"path":"/Users/curry/IdeaProjects/web/src/views/info/Goods.vue","mtime":1645094060474},{"path":"/Users/curry/IdeaProjects/web/node_modules/css-loader/index.js","mtime":1644834704815},{"path":"/Users/curry/IdeaProjects/web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1644834877865},{"path":"/Users/curry/IdeaProjects/web/node_modules/postcss-loader/src/index.js","mtime":1644834877019},{"path":"/Users/curry/IdeaProjects/web/node_modules/less-loader/dist/cjs.js","mtime":1644834920680},{"path":"/Users/curry/IdeaProjects/web/node_modules/cache-loader/dist/cjs.js","mtime":1644834874663},{"path":"/Users/curry/IdeaProjects/web/node_modules/vue-loader/lib/index.js","mtime":1644834877865}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.pageInfo {\n  padding-top: 24px;\n  float: right;\n}\n",{"version":3,"sources":["Goods.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4eA;AACA;AACA;AACA","file":"Goods.vue","sourceRoot":"src/views/info","sourcesContent":["<template>\n  <div>\n    <a-button type=\"primary\" @click=\"addStore\">\n       <span>添加商品</span>\n      <a-icon :component=\"add\"/>\n    </a-button>\n    <div  style=\"margin: 15px 0px;\">\n      <a-input  placeholder=\"商品名称\" style=\"width:240px;\" v-model=\"goodsName\"></a-input>\n      <a-input  placeholder=\"商品编号\" style=\"width:240px;\" v-model=\"goodsNum\"></a-input>\n      <a-button type=\"primary\" style=\"margin-left: 10px;\" @click=\"search\">搜索</a-button>\n    </div>\n    <div>\n    <a-table :columns=\"columns\" :dataSource=\"infoList\"  :pagination=\"false\">\n        <span slot=\"timeFormat\" slot-scope=\"text, record\">\n             {{ record.createTime.replace(\"T\",\" \") }}\n        </span>\n        <template slot=\"operation\" slot-scope=\"text, record\">\n          <a-button type=\"primary\" @click=\"upStock(record.id)\" >库存添加</a-button>\n        </template>\n    </a-table>\n      <div class=\"pageInfo\">\n        <a-pagination\n          :total=total\n          :pageSize=pageParams.pageSize\n          :current=pageParams.pageNum\n          :showTotal=\"(total, range) => `共${total}条数据`\"\n          @change=\"pageChange\"\n          @showSizeChange=\"pageChange\"\n        />\n      </div>\n    </div>\n    <div  v-show=\"showAddmodal\">\n      <a-modal\n        title=\"\"\n        v-model=\"showAddmodal\"\n        width=\"1000px\"\n        :maskClosable=\"false\"\n        :footer=\"null\"\n        :closable=\"false\"\n        style=\"top: 20px;bottom: 0px;\"\n\n      >\n        <div class=\"modal-header\" @click=\"closeAlert\">\n          <a-icon :component=\"close\" style=\"font-size: 22px\"/>\n        </div>\n        <br>\n        <div class=\"modal-header-content\">\n          <span style=\"font-size: 20px;color: black\">添加商品</span>\n        </div>\n        <a-row>\n          <a-col :md=\"24\" :sm=\"24\"  class=\"modal-content-item\">\n            <span>商品名称</span>\n            <a-input placeholder=\"输入商品名称\" class=\"item-input\"  v-model=\"addValue.goodsName\"/>\n          </a-col>\n          <a-col :md=\"24\" :sm=\"24\"  class=\"modal-content-item\">\n            <span>商品编号</span>\n            <a-input placeholder=\"输入商品编号\" class=\"item-input\" v-model=\"addValue.goodsNum\"/>\n          </a-col>\n          <a-col :md=\"24\" :sm=\"24\"  class=\"modal-content-item\">\n            <span>商品库存</span>\n            <div class=\"postio\"><a-input placeholder=\"商品库存\"  v-model=\"addValue.goodsStock\"/></div>\n            <!--<p class=\"lookpart\">查看定位</p>-->\n          </a-col>\n            <!-- <a-upload\n                name=\"file\"\n                list-type=\"picture-card\"\n                class=\"avatar-uploader\"\n                :show-upload-list=\"false\"\n                action=\"http://127.0.0.1:8082/file/upload\"\n                :before-upload=\"beforeUpload\"\n                @change=\"handleChange\"\n            >\n                <img v-if=\"imageUrl\" :src=\"imageUrl\" alt=\"avatar\" />\n                <div v-else>\n                <a-icon :type=\"loading ? 'loading' : 'plus'\" />\n                <div class=\"ant-upload-text\">\n                    Upload\n                </div>\n                </div>\n            </a-upload> -->\n        </a-row>\n\n        <div class=\"modal-content-bottom\">\n          <a-button type=\"primary\" :loading=\"loadingSave\" @click=\"saveInfo\">保存</a-button>\n          <a-button style=\"margin-left: 10px\" @click=\"closeAlert\">返回</a-button>\n        </div>\n      </a-modal>\n    </div>\n    <!-- -->\n    <div  v-show=\"showAddStModal\">\n      <a-modal\n        title=\"\"\n        v-model=\"showAddStModal\"\n        width=\"600px\"\n        :maskClosable=\"false\"\n        :footer=\"null\"\n        :closable=\"false\"\n        style=\"top: 20px;bottom: 0px;\"\n\n      >\n        <div class=\"modal-header\" @click=\"closeAlert\">\n          <a-icon :component=\"close\" style=\"font-size: 22px\"/>\n        </div>\n        <br>\n        <div class=\"modal-header-content\">\n          <span style=\"font-size: 20px;color: black\">添加库存</span>\n        </div>\n        <a-row>\n          <a-col :md=\"24\" :sm=\"24\"  class=\"modal-content-item\">\n            <span>商品库存</span>\n            <div class=\"postio\"><a-input placeholder=\"商品库存\"  v-model=\"upGoodsStock\"/></div>\n            <!--<p class=\"lookpart\">查看定位</p>-->\n          </a-col>\n        </a-row>\n\n        <div class=\"modal-content-bottom\">\n          <a-button type=\"primary\" :loading=\"loadingSave\" @click=\"saveStock\">保存</a-button>\n          <a-button style=\"margin-left: 10px\" @click=\"closeAlert\">返回</a-button>\n        </div>\n      </a-modal>\n    </div>\n  </div>\n\n\n\n</template>\n\n<script>\n  import {getList,addInfo,addStock} from '@/api/goods'\n  import add from '@/assets/yard/add.svg?inline'\n  import {mapGetters} from 'vuex'\n  import VueAmap from 'vue-amap'\n  export default {\n    name: 'Goods',\n    data(){\n       return{\n         add,\n         addValue:{\n          goodsName:'',\n          goodsNum:'',\n          goodsStock:''\n         },\n         upGoodsId:'',\n         upGoodsStock:'',\n         showAddStModal:false,\n         showAddmodal:false,\n         loadingSave:false,\n         loading:false,\n         infoList:[],\n         goodsName:\"\",\n         goodsNum:\"\",\n         imageUrl: '',\n         total:0, //列表总条数\n         pageParams:{\n           goodsName:\"\",\n           goodsNum:\"\",\n           warehouseId:\"\",\n           pageSize: 10,\n           pageNum: 1,\n           // total: 10\n         },\n         columns:[\n           {\n             title: '商品名称',\n             dataIndex: 'goodsName',\n           }, {\n             title: '商品编号',\n             dataIndex: 'goodsNum',\n           }, {\n             title: '商品库存',\n             dataIndex: 'goodsStock',\n           },\n           {\n             title: '创建时间',\n             dataIndex: 'createTime',\n             scopedSlots: { customRender: 'timeFormat' },\n           },\n          {\n             title: '修改时间',\n             dataIndex: 'updateTime',\n             scopedSlots: { customRender: 'timeFormat' },\n           },\n           {\n                title: '操作',\n                scopedSlots: { customRender: 'operation' }\n            }\n         ],\n          marker:\n          {\n            position: [108.95355,34.263977],\n            events: {\n              click: () => {\n\n              },\n              dragend: (e) => {\n\n              }\n            },\n            visible: true,\n            draggable: false,\n            label:{\n              content:'西安',\n              offset:[0,30]\n            },\n\n          },\n        amapManager:{},\n        isSelectClickMap:false,\n        zoom: 12,\n        center:[108.95355,34.263977],\n        events: {\n          init: (o) => {\n\n          },\n          'moveend': () => {\n          },\n          'zoomchange': () => {\n          },\n          'click': (e) => {\n\n              // 这里通过高德 SDK 完成。\n              var geocoder = new AMap.Geocoder({\n                radius: 1000,\n                extensions: \"all\"\n              });\n              var that=this;\n              that.addValue.lnglat=[e.lnglat.lng ,e.lnglat.lat];\n              this.marker.position=[e.lnglat.lng ,e.lnglat.lat];\n              geocoder.getAddress([e.lnglat.lng ,e.lnglat.lat], function(status, result) {\n                if (status === 'complete' && result.info === 'OK') {\n                  if (result && result.regeocode) {\n                    // console.log(result)\n                    if(result.regeocode.addressComponent.province != \"\"){\n                      that.addValue.select.province = result.regeocode.addressComponent.province;\n                    }\n                    if(result.regeocode.addressComponent.city != \"\"){\n                      that.addValue.select.city = result.regeocode.addressComponent.city;\n                    }\n                    if(result.regeocode.addressComponent.district != \"\"){\n                      that.addValue.select.area = result.regeocode.addressComponent.district;\n                    }\n\n                    // that.addValue.select.province = result.regeocode.addressComponent.province;\n                    // that.addValue.select.city = result.regeocode.addressComponent.city;\n                    // that.addValue.select.area = result.regeocode.addressComponent.district;\n\n                    that.addValue.detailAddr = result.regeocode.addressComponent.township+ result.regeocode.addressComponent.street + result.regeocode.addressComponent.streetNumber;\n                    that.marker.label={\n                      content : result.regeocode.addressComponent.township+ result.regeocode.addressComponent.street + result.regeocode.addressComponent.streetNumber,\n                      offset:[0,-28]\n                    }//;\n                  }\n                }\n              });\n\n          }\n        },\n        plugin: [],\n        autoOptions:{\n          city: '全国',\n          citylimit:true\n        }\n\n\n      }\n    },\n    watch:{\n      showAddmodal(newVal,oldVal){\n\n        if(!newVal){\n          this.closeAlert();\n        }\n      }\n    },\n    methods:{\n      ...mapGetters([\"userInfo\"]),\n      addStore(){\n        this.showAddmodal=true\n        this.isSelectClickMap=false;\n        console.log( this.isSelectClickMap)\n\n      },\n      upStock(id){\n        this.showAddStModal=true\n        this.upGoodsId = id\n      },\n      saveStock(){\n        let params={\n          id:this.upGoodsId,\n          goodsStock:this.upGoodsStock\n        };\n        // console.log(params)\n        if(params.goodsStock.length<=0){\n          this.$notification['warning']({\n            message: '提示',\n            description: '添加库存不能为空',\n            duration: 2\n          })\n          return;\n        }\n        this.loadingSave=true;\n        //判断是不是在编辑，编辑的话提交数据到编辑接口，新增的话提交数据到新增接口\n        addStock(params).then(res=>{\n            if(res.code==200){\n              this.$notification['success']({\n                message: '提示',\n                description: res.msg,\n                duration: 2\n              })\n              this.closAddSt();\n              this.getPageList();\n            }else{\n              this.$notification['warning']({\n                message: '提示',\n                description: res.msg,\n                duration: 2\n              })\n            }\n            this.loadingSave=false;\n          }).catch(e=>{\n            this.loadingSave=false;\n            this.$notification['error']({\n              message: '提示',\n              description: \"添加失败，网络错误\",\n              duration: 2\n            })\n          })\n\n      },\n\n      /**\n       * 关闭弹窗\n       */\n      closAddSt(){\n          this.showAddStModal=false;\n      },\n      closeAlert(){\n        this.showAddmodal=false;\n        this.contruldress=false;\n        this.center=[116.416357, 39.928353];\n        this.isEdit=true;\n        this.isSelectClickMap=false;\n        if(this.isEdit){\n          this.isEdit=false;\n        }\n\n      },\n      async getPageList(){\n        this.loading = true\n        try {\n          this.pageParams.goodsName=this.goodsName;\n          this.pageParams.warehouseId = this.$route.params.warehouseId;\n          this.pageParams.goodsNum=this.goodsNum;\n          let res=await getList(this.pageParams);\n          this.loading = false\n          if(res.code==200) {\n            this.infoList=res.data.list;\n            this.total=res.data.total;\n            // this.pageParams.total = res.rowCount\n          }else {\n            this.$message.error(res.message, 2)\n          }\n        }catch (e) {\n          this.loading = false\n          this.$message.error(\"网络错误\",2);\n        }\n      },\n      search(){\n        this.pageParams.pageNum=1;\n        this.pageParams.pageSize=10;\n        this.getPageList()\n      },\n      pageChange(page,size){ //修改分页\n        this.pageParams.pageSize=size\n        this.pageParams.pageNum=page\n        // reqParams\n        this.getPageList()\n\n      },\n         /**\n       * 保存仓库\n       * */\n      saveInfo(){\n        let params={\n          goodsName:this.addValue.goodsName,\n          goodsNum:this.addValue.goodsNum,\n          goodsStock:this.addValue.goodsStock,\n          imgUrl:this.imageUrl,\n          warehouseId:this.$route.params.warehouseId\n        };\n        // console.log(params)\n        if(params.goodsName.length<=0){\n          this.$notification['warning']({\n            message: '提示',\n            description: '名称不能为空',\n            duration: 2\n          })\n          return;\n        }\n        if(params.goodsNum.length<=5){\n          this.$notification['warning']({\n            message: '提示',\n            description: '编号格式不正确(5-10位)',\n            duration: 2\n          })\n          return;\n        }\n        if(params.goodsStock.length<=0){\n          this.$notification['warning']({\n            message: '提示',\n            description: '库存必须填写',\n            duration: 2\n          })\n          return;\n        }\n        this.loadingSave=true;\n        //判断是不是在编辑，编辑的话提交数据到编辑接口，新增的话提交数据到新增接口\n        addInfo(params).then(res=>{\n            if(res.code==200){\n              this.$notification['success']({\n                message: '提示',\n                description: res.msg,\n                duration: 2\n              })\n              this.closeAlert();\n              this.getPageList();\n            }else{\n              this.$notification['warning']({\n                message: '提示',\n                description: res.msg,\n                duration: 2\n              })\n            }\n            this.loadingSave=false;\n          }).catch(e=>{\n            this.loadingSave=false;\n            this.$notification['error']({\n              message: '提示',\n              description: \"添加失败，网络错误\",\n              duration: 2\n            })\n          })\n      },\n      //图片上传\n        handleChange(info) {\n            console.log(info)\n            if (info.file.status === 'uploading') {\n                this.loading = true;\n                return;\n            }\n            if (info.file.status === 'done') {\n                this.getBase64(info.file.originFileObj, imageUrl => {\n                this.imageUrl = info.file.response.data;\n                this.loading = false;\n                });\n            }\n        },\n        getBase64(img, callback) {\n            const reader = new FileReader();\n            reader.addEventListener('load', () => callback(reader.result));\n            reader.readAsDataURL(img);\n        },\n        beforeUpload(file) {\n            const isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\n            if (!isJpgOrPng) {\n                this.$message.error('请上传一个jpg或png图片!');\n            }\n            const isLt2M = file.size / 1024 / 1024 < 2;\n            if (!isLt2M) {\n                this.$message.error('I图片不能大于2MB!');\n            }\n            return isJpgOrPng && isLt2M;\n        },\n\n\n      changeValue(v){\n        if(this.isSelectClickMap){\n          this.searchAddr(this.addValue.detailAddr);\n        }else{\n          this.addValue.detailAddr='';\n          this.$message.warn(\"请先选择省市区\",1);\n        }\n      },\n    },\n    created(){\n       this.amapManager=new VueAmap.AMapManager();\n       this.getPageList()\n    }\n  }\n</script>\n\n<style  scoped lang=\"less\">\n  .pageInfo {\n    padding-top: 24px;\n    float: right;\n  }\n</style>"]}]}